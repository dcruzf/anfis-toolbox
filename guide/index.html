
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive Python implementation of Adaptive Neuro-Fuzzy Inference Systems (ANFIS)">
      
      
      
        <link rel="canonical" href="https://dcruzf.github.io/anfis-toolbox/guide/">
      
      
      
      
      <link rel="icon" href="../assets/icon.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Developer Guide - ANFIS Toolbox</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/timeago.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#developer-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ANFIS Toolbox" class="md-header__button md-logo" aria-label="ANFIS Toolbox" data-md-component="logo">
      
  <img src="../assets/icon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ANFIS Toolbox
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Developer Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="light-indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/dcruzf/anfis-toolbox" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    dcruzf/anfis-toolbox
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../estimators/anfis-regressor/" class="md-tabs__link">
          
  
  
    
  
  Estimators

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../membership_functions/gaussian/" class="md-tabs__link">
          
  
  
    
  
  Membership Functions

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../examples/regression_basic/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ANFIS Toolbox" class="md-nav__button md-logo" aria-label="ANFIS Toolbox" data-md-component="logo">
      
  <img src="../assets/icon.svg" alt="logo">

    </a>
    ANFIS Toolbox
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dcruzf/anfis-toolbox" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    dcruzf/anfis-toolbox
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Estimators
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Estimators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../estimators/anfis-regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../estimators/anfis-classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classification
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Membership Functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Membership Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/gaussian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/gaussian-combination/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gaussian Combination
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/bell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bell-shaped
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/pi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pi-shaped
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/triangular/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Triangular
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/trapezoidal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trapezoidal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/sigmoidal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sigmoidal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/sigmoidal-difference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Difference of Sigmoidal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/sigmoidal-product/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Product of Sigmoidal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/zshaped/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Z-shaped
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/zshaped-linear/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear Z-shaped
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/sshaped/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    S-shaped
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../membership_functions/sshaped-linear/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linear S-shaped
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/regression_basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/classifier_basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/classifier_iris/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Iris Classification
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/time_series/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/function_approximation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Function Approximation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../api/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Estimators
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Estimators
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/regressor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Regressor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Classifier
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/membership-functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Membership Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/optim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimization Trainers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/losses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Losses
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/layers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Layers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Utilities
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/builders/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Builders
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/clustering/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Clustering
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#project-goals" class="md-nav__link">
    <span class="md-ellipsis">
      Project Goals
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#repository-layout" class="md-nav__link">
    <span class="md-ellipsis">
      Repository Layout
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-level-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      High-Level Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-and-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation and Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation and Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-execution-pipeline-anfis_toolboxmodel-and-anfis_toolboxlayers" class="md-nav__link">
    <span class="md-ellipsis">
      Core execution pipeline (anfis_toolbox.model and anfis_toolbox.layers)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#builder-and-configuration-layer-builderspy-configpy" class="md-nav__link">
    <span class="md-ellipsis">
      Builder and configuration layer (builders.py, config.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estimator-orchestration-regressorpy-classifierpy-estimator_utilspy" class="md-nav__link">
    <span class="md-ellipsis">
      Estimator orchestration (regressor.py, classifier.py, estimator_utils.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-infrastructure-optim" class="md-nav__link">
    <span class="md-ellipsis">
      Training infrastructure (optim/)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variants-and-extension-points" class="md-nav__link">
    <span class="md-ellipsis">
      Variants and extension points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uml-overview" class="md-nav__link">
    <span class="md-ellipsis">
      UML overview
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-estimators" class="md-nav__link">
    <span class="md-ellipsis">
      Working With Estimators
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#membership-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Membership Functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Training Strategies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metrics-and-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics and Evaluation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples-and-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      Examples and Documentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      Development Workflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      Contributing
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="developer-guide">Developer Guide<a class="headerlink" href="#developer-guide" title="Permanent link">&para;</a></h1>
<p>Welcome to the ANFIS Toolbox developer guide. This document is intended for
contributors who want to understand the architecture, extend the library, or
work on the documentation and examples. If you are looking for the user-facing
API reference, consult the generated MkDocs site or the module docstrings.</p>
<h2 id="project-goals">Project Goals<a class="headerlink" href="#project-goals" title="Permanent link">&para;</a></h2>
<ul>
<li>Provide a batteries-included Adaptive Neuro-Fuzzy Inference System (ANFIS)
    implementation in Python.</li>
<li>Offer high-level estimators (<code>ANFISRegressor</code>, <code>ANFISClassifier</code>) that feel
    familiar to scikit-learn users while remaining dependency-free.</li>
<li>Support a wide range of membership function families and training regimes.</li>
<li>Ship with reproducible examples, thorough tests, and easy-to-read docs.</li>
</ul>
<h2 id="repository-layout">Repository Layout<a class="headerlink" href="#repository-layout" title="Permanent link">&para;</a></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>anfis_toolbox/
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>├── model.py              # Low-level ANFIS graph (layers, forward passes)
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>├── regressor.py          # High-level regression estimator facade
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>├── classifier.py         # High-level classification estimator facade
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>├── membership.py         # Membership function implementations and helpers
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>├── builders.py           # Utilities that assemble models from configuration
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>├── optim/                # Optimizer and trainer implementations
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>├── metrics.py            # Regression and classification metric utilities
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>├── losses.py             # Loss definitions shared by optimizers
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>└── estimator_utils.py    # Mixins, validation helpers, sklearn-like machinery
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>docs/                     # MkDocs pages and reference material
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>docs/examples/            # Notebook-based walkthroughs
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>tests/                    # Pytest suite with full coverage
</span></code></pre></div>
<h2 id="high-level-architecture">High-Level Architecture<a class="headerlink" href="#high-level-architecture" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Estimators</strong> (<code>ANFISRegressor</code>, <code>ANFISClassifier</code>) expose a drop-in API
     with <code>fit</code>, <code>predict</code>, <code>predict_proba</code> (classifier), <code>evaluate</code>, and
     serialization helpers (<code>save</code>, <code>load</code>). They orchestrate membership
     generation, rule configuration, optimizer instantiation, and evaluation.</li>
<li><strong>Builders</strong> translate estimator configuration into the low-level model by
     creating membership functions, calculating rule combinations, and producing
     an object the trainers can consume.</li>
<li><strong>Low-level model</strong> (<code>model.ANFIS</code>, <code>model.TSKANFISClassifier</code>) implements
     the forward pass, rule firing strengths, normalization, and consequent
     evaluation.</li>
<li><strong>Optimizers</strong> (<code>optim.*</code>) encapsulate training strategies such as Hybrid
     (OLS + gradient descent), Adam, RMSProp, SGD, and PSO. Each trainer accepts a
     low-level model along with data and optional validation splits.</li>
<li><strong>Utilities</strong> provide common infrastructure: <code>estimator_utils</code> for mixins
     and input validation, <code>metrics</code> for reporting, <code>losses</code> for objective
     functions, and <code>logging_config</code> for opt-in training logs.</li>
</ol>
<p>The diagram below illustrates the runtime flow:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>User code -&gt; ANFISRegressor.fit ------------------------------.
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>                            |                                  |
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>                            v                                  |
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>                Membership config     Optimizer selection      |
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>                            |                    |             |
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>                            v                    v             |
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>                builders.ANFISBuilder  optim.&lt;Trainer&gt;         |
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>                            |                    |             |
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>                            &#39;------&gt; model.ANFIS &lt;-------------&#39;
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>                                                               |
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>                                                               v
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>                                                         Training loop
</span></code></pre></div>
<h2 id="implementation-and-architecture">Implementation and Architecture<a class="headerlink" href="#implementation-and-architecture" title="Permanent link">&para;</a></h2>
<p>ANFIS Toolbox implements the flow above through a set of small, composable modules. The public estimators in
<code>anfis_toolbox.regressor</code> and <code>anfis_toolbox.classifier</code> act as façades that translate user-friendly configuration into the
lower-level computational graph defined in <code>anfis_toolbox.model</code> and <code>anfis_toolbox.layers</code>. Supporting modules such as
<code>builders</code>, <code>config</code>, <code>membership</code>, <code>losses</code>, and <code>optim</code> provide reusable building blocks that keep concerns separated.</p>
<h3 id="core-execution-pipeline-anfis_toolboxmodel-and-anfis_toolboxlayers">Core execution pipeline (<code>anfis_toolbox.model</code> and <code>anfis_toolbox.layers</code>)<a class="headerlink" href="#core-execution-pipeline-anfis_toolboxmodel-and-anfis_toolboxlayers" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Fuzzification</strong> sits in <code>MembershipLayer</code>, which wraps concrete membership-function objects. The layer caches the raw
    inputs and per-function activations so that the backward pass can recover gradients without re-evaluating membership
    functions.</li>
<li><strong>Rule evaluation</strong> is performed by <code>RuleLayer</code>. It receives the membership lattice, expands (or filters) the Cartesian
    product of membership indices, and computes rule firing strengths using the configured T-norm (product). The layer also
    propagates derivatives back to the membership layer by reusing the cached activations.</li>
<li><strong>Normalization</strong> is handled by <code>NormalizationLayer</code>, which performs numerically stable weight normalisation and exposes a
    Jacobian-vector product in its <code>backward</code> method so that trainers can work directly with batched gradients.</li>
<li><strong>Consequents</strong> are implemented by <code>ConsequentLayer</code> (regression) and <code>ClassificationConsequentLayer</code> (classification).
    Both layers augment the input batch with biases, compute per-rule linear consequents, and aggregate them using the
    normalised firing strengths. The classification flavour maps the weighted outputs to logits, and integrates with the
    built-in softmax helper in <code>metrics.py</code>.</li>
<li><strong>Model orchestration</strong> happens in <code>TSKANFIS</code> and <code>TSKANFISClassifier</code>. Each model wires the layers, exposes forward and
    backward passes, persists gradient buffers, and implements <code>get_parameters</code>, <code>set_parameters</code>, and <code>update_parameters</code> so
    optimizers can operate without needing to understand layer internals.</li>
</ul>
<h3 id="builder-and-configuration-layer-builderspy-configpy">Builder and configuration layer (<code>builders.py</code>, <code>config.py</code>)<a class="headerlink" href="#builder-and-configuration-layer-builderspy-configpy" title="Permanent link">&para;</a></h3>
<ul>
<li><code>ANFISBuilder</code> encapsulates membership-function synthesis. It centralises creation strategies (grid, FCM, random) and maps
    human-readable names (<code>"gaussian"</code>, <code>"bell"</code>) to concrete membership classes. The builder also normalises explicit rule
    sets via <code>set_rules</code> and exposes a <code>build()</code> factory that returns a fully wired <code>TSKANFIS</code> instance.</li>
<li><code>ANFISConfig</code> provides a serialisable description of inputs and training defaults. It can emit builders, write JSON
    configurations, and round-trip through <code>ANFISModelManager</code> alongside pickled models. This enables reproducible deployments
    or experiment tracking without shipping raw Python objects.</li>
<li>Membership families (e.g. <code>GaussianMF</code>, <code>PiMF</code>, <code>DiffSigmoidalMF</code>) live under <code>membership.py</code>. Each object exposes a
    <code>parameters</code>/<code>gradients</code> interface so the layers can mutate them generically during backpropagation.</li>
</ul>
<h3 id="estimator-orchestration-regressorpy-classifierpy-estimator_utilspy">Estimator orchestration (<code>regressor.py</code>, <code>classifier.py</code>, <code>estimator_utils.py</code>)<a class="headerlink" href="#estimator-orchestration-regressorpy-classifierpy-estimator_utilspy" title="Permanent link">&para;</a></h3>
<ul>
<li><code>ANFISRegressor.fit</code> and <code>ANFISClassifier.fit</code> delegate input validation and reshaping to helpers in <code>estimator_utils</code>,
    ensuring NumPy arrays, pandas DataFrames, and Python iterables are handled consistently.</li>
<li>During fitting, estimators resolve per-input overrides through <code>_resolve_input_specs</code>, instantiate an <code>ANFISBuilder</code>,
    build the low-level model, select a trainer based on string aliases or explicit objects, and finally call
    <code>trainer.fit(model, X, y, **kwargs)</code>. The resulting history dictionary is cached in <code>training_history_</code> for downstream
    inspection.</li>
<li>Persistence relies on the estimator mixins: <code>save</code>/<code>load</code> methods serialise the estimator and underlying model with
    <code>pickle</code>, and <code>format_estimator_repr</code> produces concise <code>__repr__</code> output that mirrors scikit-learn conventions.</li>
<li>Logging hooks are opt-in through <code>logging_config.enable_training_logs</code>, so verbose fits emit trainer progress while
    remaining silent by default.</li>
</ul>
<h3 id="training-infrastructure-optim">Training infrastructure (<code>optim/</code>)<a class="headerlink" href="#training-infrastructure-optim" title="Permanent link">&para;</a></h3>
<ul>
<li><code>BaseTrainer</code> defines the contract (<code>fit</code>, <code>evaluate</code>, metric tracking) and shared utilities like batching, progress
    reporting, and validation scheduling.</li>
<li>Gradient-based trainers (<code>HybridTrainer</code>, <code>HybridAdamTrainer</code>, <code>AdamTrainer</code>, <code>RMSPropTrainer</code>, <code>SGDTrainer</code>) call the
    model's <code>forward</code>, <code>backward</code>, <code>update_parameters</code>, and <code>reset_gradients</code> methods directly. Hybrid variants alternate
    between closed-form least-squares updates for consequents and gradient descent for membership parameters to accelerate
    convergence on regression tasks.</li>
<li><code>PSOTrainer</code> diverges from gradient descent by optimising consequent coefficients with particle swarm optimisation while
    refreshing membership parameters less aggressively, making it suitable for noisy or non-differentiable objectives.</li>
<li>All trainers populate a <code>TrainingHistory</code> mapping (defined in <code>optim.base</code>) that captures per-epoch losses and optional
    validation metrics, facilitating visualisation or early-stopping criteria implemented outside the core package.</li>
</ul>
<h3 id="variants-and-extension-points">Variants and extension points<a class="headerlink" href="#variants-and-extension-points" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Regression vs. classification</strong>: <code>ANFISRegressor</code> wraps <code>TSKANFIS</code>, using mean-squared-error-style losses by default and
    exposing regression metrics. <code>ANFISClassifier</code> wraps <code>TSKANFISClassifier</code>, instantiates a multi-class consequent layer,
    and defaults to cross-entropy losses with probability calibration via <code>predict_proba</code>.</li>
<li><strong>Membership variants</strong>: Users can mix automatic generation (<code>n_mfs</code>, <code>mf_type</code>, <code>init</code>, <code>overlap</code>, <code>margin</code>) with explicit
    <code>MembershipFunction</code> instances per feature. Builders preserve the order in which inputs are added so the resulting rule
    indices remain deterministic.</li>
<li><strong>Rule customisation</strong>: Providing <code>rules=[(...)]</code> to estimators or builders prunes the Cartesian-product rule set. The
    <code>RuleLayer</code> validates dimensionality and membership bounds so sparsified rule bases remain consistent.</li>
<li><strong>Custom trainers and losses</strong>: Passing a subclass of <code>BaseTrainer</code> or a callable <code>LossFunction</code> lets advanced users swap
    in bespoke optimisation strategies. Trainers may register additional callbacks or hooks (for example, to integrate with
    <code>docs/hooks/*</code> when rendering docs) without patching the core model.</li>
<li><strong>Configuration persistence</strong>: <code>ANFISModelManager</code> ties trained models to the serialised configuration extracted from the
    membership catalogue, enabling reproducible evaluation environments and lightweight deployment artefacts.</li>
</ul>
<h3 id="uml-overview">UML overview<a class="headerlink" href="#uml-overview" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>classDiagram
    direction LR
    class ANFISRegressor {
        +fit(X, y)
        +predict(X)
        +evaluate(X, y)
        +save(path)
        +load(path)
    }
    class ANFISClassifier {
        +fit(X, y)
        +predict(X)
        +predict_proba(X)
        +evaluate(X, y)
    }
    class ANFISBuilder {
        +add_input(name, min, max, n_mfs, mf_type)
        +add_input_from_data(name, data, ...)
        +set_rules(rules)
        +build()
    }
    class TSKANFIS {
        +forward(X)
        +backward(dL)
        +fit(X, y, trainer)
        +get_parameters()
    }
    class TSKANFISClassifier {
        +forward(X)
        +backward(dL)
        +predict_logits(X)
        +get_parameters()
    }
    class MembershipLayer {
        +forward(X)
        +backward(gradients)
    }
    class RuleLayer {
        +forward(mu)
        +backward(dL)
    }
    class NormalizationLayer {
        +forward(weights)
        +backward(dL)
    }
    class ConsequentLayer {
        +forward(X, w)
        +backward(dL)
    }
    class ClassificationConsequentLayer {
        +forward(X, w)
        +backward(dL)
    }
    class BaseTrainer {
        &lt;&lt;abstract&gt;&gt;
        +fit(model, X, y)
    }
    class HybridTrainer
    class HybridAdamTrainer
    class AdamTrainer
    class RMSPropTrainer
    class SGDTrainer
    class PSOTrainer

    ANFISRegressor --&gt; ANFISBuilder : configures
    ANFISClassifier --&gt; ANFISBuilder : configures
    ANFISBuilder --&gt; TSKANFIS : builds
    ANFISBuilder --&gt; TSKANFISClassifier : builds
    TSKANFIS --&gt; MembershipLayer : composes
    TSKANFIS --&gt; RuleLayer
    TSKANFIS --&gt; NormalizationLayer
    TSKANFIS --&gt; ConsequentLayer
    TSKANFISClassifier --&gt; MembershipLayer
    TSKANFISClassifier --&gt; RuleLayer
    TSKANFISClassifier --&gt; NormalizationLayer
    TSKANFISClassifier --&gt; ClassificationConsequentLayer
    ANFISRegressor --&gt; BaseTrainer : selects
    ANFISClassifier --&gt; BaseTrainer : selects
    BaseTrainer &lt;|-- HybridTrainer
    BaseTrainer &lt;|-- HybridAdamTrainer
    BaseTrainer &lt;|-- AdamTrainer
    BaseTrainer &lt;|-- RMSPropTrainer
    BaseTrainer &lt;|-- SGDTrainer
    BaseTrainer &lt;|-- PSOTrainer</code></pre>
<h2 id="working-with-estimators">Working With Estimators<a class="headerlink" href="#working-with-estimators" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Initialization</strong>: Provide global defaults (<code>n_mfs</code>, <code>mf_type</code>, <code>init</code>,
    <code>overlap</code>, <code>margin</code>) plus optional <code>inputs_config</code> overrides for each input.
    <code>inputs_config</code> values can be dictionaries with membership parameters or
    explicit <code>MembershipFunction</code> instances.</li>
<li><strong>Rules</strong>: By default, all membership combinations form rules. Supply
    <code>rules=[(i1, i2, ...)]</code> to restrict to a subset of combinations.</li>
<li><strong>Optimizers</strong>: Pass <code>optimizer="adam"</code> (default classifier) or
    <code>optimizer="hybrid"</code> (default regressor). You can also supply instantiated
    trainers or custom subclasses of <code>BaseTrainer</code>.</li>
<li><strong>Training</strong>: <code>fit</code> accepts NumPy arrays, array-like objects, or pandas
    DataFrames. Use <code>validation_data=(X_val, y_val)</code> to monitor generalization.</li>
<li><strong>Evaluation</strong>: <code>evaluate</code> returns a metrics dictionary and optionally prints
    a nicely formatted summary. Use <code>return_dict=False</code> to suppress the return
    value.</li>
<li><strong>Persistence</strong>: <code>save</code> and <code>load</code> rely on <code>pickle</code>. Saved estimators capture
    fitted membership functions, rules, and optimizer state, enabling reuse.</li>
</ul>
<h2 id="membership-functions">Membership Functions<a class="headerlink" href="#membership-functions" title="Permanent link">&para;</a></h2>
<p>Membership families live in <code>membership.py</code>. Key points:</p>
<ul>
<li>Each family subclasses <code>MembershipFunction</code> and implements <code>__call__</code>,
    <code>derivative</code>, and metadata accessors.</li>
<li>Many families accept parameters such as centers, widths, slopes, or plateaus.</li>
<li>Builders automatically infer parameters using grid spacing, fuzzy C-means
    clustering, or random sampling depending on <code>init</code>.</li>
<li>
<p>Provide explicit membership functions via <code>inputs_config</code> to lock down
    shapes, e.g.:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">anfis_toolbox.membership</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianMF</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">inputs_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>        <span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;membership_functions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">GaussianMF</span><span class="p">(</span><span class="n">mean</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">GaussianMF</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)]},</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>        <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>  <span class="c1"># shorthand for n_mfs=4 using estimator defaults</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="p">}</span>
</span></code></pre></div>
</li>
</ul>
<h2 id="training-strategies">Training Strategies<a class="headerlink" href="#training-strategies" title="Permanent link">&para;</a></h2>
<p>Optimizers live under <code>anfis_toolbox/optim/</code> and share a common interface:</p>
<ul>
<li><code>BaseTrainer.fit(model, X, y, **kwargs)</code> drives epochs, batching, shuffling,
    and validation.</li>
<li>Hybrid trainers combine gradient descent with ordinary least squares rule
    consequent updates, delivering fast convergence on regression tasks.</li>
<li>Adam, RMSProp, and SGD offer familiar gradient-based alternatives.</li>
<li>PSO provides a population-based search when gradient information is noisy.</li>
<li>Trainers expose hooks for learning rate, epochs, batch size, shuffle, and
    optional loss overrides.</li>
</ul>
<h2 id="metrics-and-evaluation">Metrics and Evaluation<a class="headerlink" href="#metrics-and-evaluation" title="Permanent link">&para;</a></h2>
<ul>
<li><code>ANFISRegressor.evaluate</code> reports MSE, RMSE, MAE, and R² via
    <code>metrics.ANFISMetrics.regression_metrics</code>.</li>
<li><code>ANFISClassifier.evaluate</code> reports accuracy, balanced accuracy, macro/micro
    precision/recall/F1, and the confusion matrix.</li>
<li>Metrics are returned as dictionaries to simplify logging or experiment
    tracking.</li>
</ul>
<h2 id="examples-and-documentation">Examples and Documentation<a class="headerlink" href="#examples-and-documentation" title="Permanent link">&para;</a></h2>
<ul>
<li>Explore the <code>docs/examples/</code> notebooks for step-by-step tutorials covering
    regression, classification, time series, and membership customization.</li>
<li>The MkDocs site (<code>mkdocs.yml</code>) assembles the <code>docs/</code> directory into a hosted
    documentation portal. Run <code>make docs</code> to build locally and serve via
    <code>mkdocs serve</code>.</li>
</ul>
<h2 id="development-workflow">Development Workflow<a class="headerlink" href="#development-workflow" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Install dependencies</strong>: <code>make install</code></li>
<li><strong>Run tests</strong>: <code>make test</code></li>
<li><strong>Lint</strong>: <code>make lint</code></li>
<li><strong>Format (optional)</strong>: <code>make format</code></li>
<li><strong>Docs preview</strong>: <code>make docs</code></li>
</ol>
<p>Tests cover membership functions, optimizers, estimators, and integration with
scikit-learn-like patterns. New features should include corresponding tests.</p>
<h2 id="contributing">Contributing<a class="headerlink" href="#contributing" title="Permanent link">&para;</a></h2>
<ul>
<li>Fork the repository and create a feature branch.</li>
<li>Keep pull requests focused; tie them to an issue when possible.</li>
<li>Update or add documentation (including this guide) when behavior changes.</li>
<li>Ensure <code>make test</code> and <code>make lint</code> pass before submitting.</li>
<li>Include demo snippets or notebooks if the feature benefits from examples.</li>
</ul>
<p>Thanks for contributing to ANFIS Toolbox! If you have questions, open a
discussion or issue on GitHub.</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 31, 2025 19:09:56 UTC"><span class="timeago" datetime="2025-10-31T19:09:56+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 31, 2025 19:09:56 UTC">2025-10-31</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 17, 2025 21:27:30 UTC"><span class="timeago" datetime="2025-10-17T21:27:30+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 17, 2025 21:27:30 UTC">2025-10-17</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Daniel França
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/dcruzf/anfis-toolbox" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/anfis-toolbox/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 444.7a20.4 20.4 0 1 1 0-40.7 20.4 20.4 0 1 1 0 40.7M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.6-183.4a20.4 20.4 0 1 1 0 40.8 20.4 20.4 0 1 1 0-40.8"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
        <script src="../js/render_latex.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>